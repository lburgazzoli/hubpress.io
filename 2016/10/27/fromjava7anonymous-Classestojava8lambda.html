<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>from(&quot;java7:anonymousClasses&quot;).to(&quot;java8:lambda&quot;)</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="description" content="">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="from(&quot;java7:anonymousClasses&quot;).to(&quot;java8:lambda&quot;)">
    <meta name="twitter:description" content="">

    <meta property="og:type" content="article">
    <meta property="og:title" content="from(&quot;java7:anonymousClasses&quot;).to(&quot;java8:lambda&quot;)">
    <meta property="og:description" content="">

    <!-- <meta name="twitter:site" content="">

<meta name="twitter:creator" content="">

<meta name="google-site-verification" content="">

<meta property="fb:admins" content="">
 -->

    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="/apple-touch-icon-precomposed.png" rel="apple-touch-icon">

    <link href="//fonts.googleapis.com/" rel="dns-prefetch">
    <link href="//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic|Open+Sans:700,400&subset=latin,latin-ext" rel="stylesheet">

    <link rel="stylesheet" href="//lburgazzoli.github.io/themes/ghostium/assets/css/main.min.css?v=1477563924447"/>
    <link rel="stylesheet" href="//lburgazzoli.github.io/themes/ghostium/assets/css/custom.css?v=1477563924447"/>
    <link rel="stylesheet" href="//lburgazzoli.github.io/themes/ghostium/assets/css/asciidoctor-foundation.css?v=1477563924447"/>




    <script type="text/javascript">
      var ga_ua = 'UA-XXXXX-X';
      
      var disqus_shortname = 'example';
      
      var enable_pjax = true;

      // Pace Options
      // ==============
      window.paceOptions = {
        catchupTime: 100,
        minTime: 100,
        elements: false,
        restartOnRequestAfter: 500,
        startOnPageLoad: false
      }

      // Ghostium Globals
      // ==============
      window.GHOSTIUM = {};
      GHOSTIUM.haveGA = typeof ga_ua !== 'undefined' && ga_ua !== 'UA-XXXXX-X';
      GHOSTIUM.haveDisqus = typeof disqus_shortname !== 'undefined' && disqus_shortname !== 'example';
      GHOSTIUM.enablePjax = typeof enable_pjax !== 'undefined' ? enable_pjax : true;
    </script>

    <script src="//lburgazzoli.github.io/themes/ghostium/assets/js/head-scripts.min.js?v=1477563924447"></script>

    <link rel="canonical" href="https://lburgazzoli.github.io/2016/10/27/fromjava7anonymous-Classestojava8lambda.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content=".: lb :." />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="from(&quot;java7:anonymousClasses&quot;).to(&quot;java8:lambda&quot;)" />
    <meta property="og:description" content="With Camel 2.18 we have introduced a few functional APIs in RouteBuilder so you can leverage lambdas to easily build your routes. this is just the beginning so you should expect more and better functional APIs in the coming versions. Let&amp;#8217;s start writing a simple and intentionally" />
    <meta property="og:url" content="https://lburgazzoli.github.io/2016/10/27/fromjava7anonymous-Classestojava8lambda.html" />
    <meta property="article:tag" content="camel" />
    <meta property="article:tag" content=" java8" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="from(&quot;java7:anonymousClasses&quot;).to(&quot;java8:lambda&quot;)" />
    <meta name="twitter:description" content="With Camel 2.18 we have introduced a few functional APIs in RouteBuilder so you can leverage lambdas to easily build your routes. this is just the beginning so you should expect more and better functional APIs in the coming versions. Let&amp;#8217;s start writing a simple and intentionally" />
    <meta name="twitter:url" content="https://lburgazzoli.github.io/2016/10/27/fromjava7anonymous-Classestojava8lambda.html" />
    
    <script type="application/ld+json">
null
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title=".: lb :." href="https://lburgazzoli.github.io/rss/" />
  </head>
  <body class="post-template tag-camel tag-java8">

    <button data-action="open-drawer" id="drawer-button" class="drawer-button"><i class="fa fa-bars"></i></button>
    <nav tabindex="-1" class="drawer">
      <div class="drawer-container">
        <!--.drawer-search(role="search")-->
        <ul role="navigation" class="drawer-list">
          
          <li class="drawer-list-item">
            <a href="https://lburgazzoli.github.io" data-pjax>
              <i class="fa fa-home"></i>Home
            </a>
          </li>
          <!-- <li class="drawer-list-item">
            <a href="https://lburgazzoli.github.io" title=".: lb :." data-pjax>
              <i class="fa fa-list-alt"></i>All posts
            </a>
          </li> -->
          <li class="drawer-list-item">
            <a href="https://lburgazzoli.github.io/rss/">
              <i class="fa fa-rss"></i>Subscribe to Feed
            </a>
          </li>
          <li class="drawer-list-divider"></li>
          <li class="drawer-list-item drawer-list-title">
            Follow me
          </li>
          
          
          <li class="drawer-list-item">
            <a href="lburgazzoli" title="Twitter" target="_blank">
              <i class="fa fa-twitter"></i>Twitter
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="lburgazzoli" title="Github" target="_blank">
              <i class="fa fa-github"></i>Github
            </a>
          </li>
          <li class="drawer-list-item">
            <a href="https://www.linkedin.com/in/lucaburgazzoli" title="LinkedIn" target="_blank">
              <i class="fa fa-linkedin"></i>LinkedIn
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <div class="drawer-overlay"></div>
    <main id="container" role="main" class="container">
      <div class="surface">
        <div class="surface-container">
          <div data-pjax-container class="content">
            
<section class="wrapper wrapper-post">
  <div class="wrapper-container">
    <article itemscope itemtype="http://schema.org/BlogPosting" role="article" class="post post tag-camel tag-java8">
        <section class="post-container">
          <header class="post-header">
            <ul class="post-meta-list">
              <li class="post-meta-item">
                <time datetime="2016-10-27" itemprop="datePublished">
                  12 hours ago
                </time>
              </li>
                <li class="post-meta-item">
                  <span class="tags"><i class="fa fa-tags"></i>
                      <span>
                      <a href="https://lburgazzoli.github.io/tag/camel/">camel</a>, <a href="https://lburgazzoli.github.io/tag/java8/"> java8</a></span>
                  </span>
                </li>
              <li class="post-meta-item">
                <a href="#disqus_thread" data-disqus-identifier="">Comments</a>
              </li>
            </ul>
            <h1 itemprop="name headline" class="post-title"><a href="https://lburgazzoli.github.io/2016/10/27/fromjava7anonymous-Classestojava8lambda.html" itemprop="url" data-pjax title="from(&quot;java7:anonymousClasses&quot;).to(&quot;java8:lambda&quot;)">from(&quot;java7:anonymousClasses&quot;).to(&quot;java8:lambda&quot;)</a></h1>
            <!--h2 itemprop="about" class="post-subtitle"></h2-->
          </header>
          <aside class="post-side">
            <div class="post-author">
                <a href="http://lburgazzoli.github.io" class="post-author-avatar">
                  <img src="https://avatars.githubusercontent.com/u/1868933?v&#x3D;3" alt="Luca Burgazzoli">
                </a>
              <div class="post-author-info">
                <a href="http://lburgazzoli.github.io" class="post-author-name">
                  Luca Burgazzoli
                </a>
                <p class="post-author-bio"></p>
              </div>
            </div>
          </aside>
          <div itemprop="articleBody" class="post-body">
            <div class="paragraph">
<p>With Camel 2.18 we have introduced a few functional APIs in RouteBuilder so you can leverage lambdas to easily build your routes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
this is just the beginning so you should expect more and better functional APIs in the coming versions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s start writing a simple and intentionally verbose Java 7 route that logs if a number is even or odd.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">from("timer:simple?period=503")
    .setBody(exchangeProperty(Exchange.TIMER_FIRED_TIME))
    .transform(new ExpressionAdapter() {
        @Override
        public Object evaluate(Exchange exchange) {
            return exchange.getIn().getBody(Date.class).getTime();
        }
    })
    .choice()
        .when(new Predicate() {
                @Override
                public boolean matches(Exchange exchange) {
                    long number = exchange.getIn().getBody(Long.class);
                    return (number &amp; 1) == 0;
                }
            })
            .to("Received even number")
        .when(new Predicate() {
                @Override
                public boolean matches(Exchange exchange) {
                    long number = exchange.getIn().getBody(Long.class);
                    return (number &amp; 1) != 0;
                }
            })
            .to("Received odd number")
    .endChoice();</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#160;<br>
You can now switch to Java 8 and start using new constructs to implement EIP:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://camel.apache.org/message-translator.html">Message Translator</a></p>
<div class="paragraph">
<p>You have a number of options to translate messages and among them you may think to use an <a href="http://camel.apache.org/expression.html">Expression</a> but unfortunately you can&#8217;t use a lambda to implement such interface as this interface is generic so you may think to use a method reference but that is not really an improvement over using a bean.</p>
</div>
<div class="paragraph">
<p>Here is where Camel 2.18 can help so you can implement the patter as below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    .transform()
        .body(Date.class, Date::getTime)</code></pre>
</div>
</div>
</li>
<li>
<p><a href="http://camel.apache.org/content-based-router.html">Content Based Router</a></p>
<div class="paragraph">
<p>A <a href="http://camel.apache.org/predicate.html">Predicate</a> can be easily implemented using lambda, like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    .when(e -&gt; (exchange.getIn().getBody(Integer.class) &amp; 1) != 0)
        .to("Received odd number")</code></pre>
</div>
</div>
<div class="paragraph">
<p>However in Camel 2.18 we can make it even easier</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    .when()
        .body(Long.class, b -&gt; (b &amp; 1) == 0)
        .to("Received odd number")</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>&#160;<br>
We are now ready to apply the new APIs to out route and rewrite it as follow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">from("timer:simple?period=503")
    .setBody(exchangeProperty(Exchange.TIMER_FIRED_TIME))
    .transform()
        .body(Date.class, Date::getTime)
    .choice()
        .when()
            .body(Long.class, b -&gt; (b &amp; 1) == 0)
            .log("Received even number ${body}")
        .when()
            .body(Long.class, b -&gt; (b &amp; 1) != 0)
            .log("Received odd number ${body}")
    .endChoice();</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The new Java 8 APIs introduced in RouteBuilder helps to reduce the amount of code but also it helps to make it clear which is the target of a Predicate/Processor/Expression,  i.e. in the example above you can easily spot that the routing is based on the content of the body.
</td>
</tr>
</table>
</div>
          </div>
          <footer class="post-footer">
            <div itemprop="author" itemscope itemtype="http://schema.org/Person" class="post-author">
                <a href="http://lburgazzoli.github.io" class="post-author-avatar">
                  <img itemprop="image" src="https://avatars.githubusercontent.com/u/1868933?v&#x3D;3" alt="Luca Burgazzoli">
                </a>
              <div class="post-author-info">
                <h4 class="post-footer-heading">Written By</h4>
                <a href="http://lburgazzoli.github.io" itemprop="url" class="post-author-name">
                  <span itemprop="name">Luca Burgazzoli</span>
                </a>
                <p itemprop="description" class="post-author-bio"></p>
                  <p class="post-author-location">Piacenza, Italy</p>
                  <p class="post-author-website">
                    <a href="http://lburgazzoli.github.io" rel="nofollow">http://lburgazzoli.github.io</a>
                  </p>
                <p class="post-info">
                  <b class="post-info-title">Published on</b>
                  <time class="post-date">October 27, 2016</time>
                </p>
              </div>
            </div>
            <div class="post-social">
              <h4 class="post-footer-heading">Spread the word</h4>
              <a href="#" data-action="share-twitter"><i class="fa fa-fw fa-lg fa-twitter"></i></a>
              <a href="#" data-action="share-facebook"><i class="fa fa-fw fa-lg fa-facebook"></i></a>
              <a href="#" data-action="share-gplus"><i class="fa fa-fw fa-lg fa-google-plus"></i></a>
            </div>
          </footer>
        </section>
      <section itemprop="comment" class="post-comments">
        <div id="disqus_thread"></div>
      </section>
    </article>

    <footer role="contentinfo" class="footer">
      <p><small>Copyright &copy; <span itemprop="copyrightHolder">.: lb :.</span>. 2016. All Rights Reserved.</small></p>
      <p><small><a href="http://ghostium.oswaldoacauan.com/" target="_blank">Ghostium Theme</a> by <a href="http://twitter.com/oswaldoacauan" target="_blank">@oswaldoacauan</a></small></p>
      <p><small>Adapted by <a href="https://twitter.com/mgreau">Maxime Gréau</a></small></p>
      <p><small>Published with <a href="http://hubpress.io">HubPress</a></small></p>
    </footer>
  </div>
</section>


<section class="post-comments">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
  var disqus_shortname = 'lburgazzoli'; // required: replace example with your forum shortname
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


          </div>
        </div>
      </div>
    </main>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();
      </script>

    <script src="//lburgazzoli.github.io/themes/ghostium/assets/js/foot-scripts.min.js?v=1477563924447"></script>


  </body>
</html>
